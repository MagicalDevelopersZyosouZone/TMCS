// '...' 有单引号为字面值，否则为标识符
// [...] 可选
// { ... | ... } 单选
// ["..."] 数组（方括号在 JSON 字符串外部）
//
// 仅在操作失败时返回 code，值为负数
// 无需返回任何数据时一律 return { code: 0 } ← 待议
//
// 草案完成后可以缩写标识符以节省数据流量

[
  //Account
  {
    "Register": {
      "params": [
        "userId",
        "publicKey",
        "[passwordHash]"
      ],
      "returns": []
    },

    "GetLoginInfo": {
      "params": [
        "userId"
      ],
      "returns": [
        "authType: { 'password' | 'privateKey' }" // 不是必须的，少暴露一些信息（例如有效的用户名）可以防止社工
      ]
    },

    "Login": {
      "params": [
        "userId",
        "{ privateKey | passwordHash }"
      ],
      "returns": []
    },

    "GetInfo": {
      "params": [
        "userId"
      ],
      "returns": [
        "name",
        "publicKey"
      ]
    },

    "SetSecretKey": {
      "params": [
        "pubKey",
        "prvKeyEnc"
      ]
    },

    // 密钥等安全信息也用这个 API 来改吗？
    "SetInfo": {
      "params": [
        "userId",
        [ "key: value" ]
      ],
      "returns": []
    }
  },

  //TMCS
  {
    "GetFriendList": {
      "params": [],
      "returns": [
        [ "userId" ]
      ]
    },

    "AddFriend": {
      "params": [ "userId" ],
      "returns": []
    },

    "SearchUsers": {
      "params": [ "name" ],
      "returns": [
        [ "userId" ]
      ]
    },

    "PullRoamingMessages": {
      "params": [ "userId", "timestamp", "count" ],
      "returns": [
        [ "timestamp", "message" ]
      ]
    },

    "SendMessage": {
      "params": [
        "userId",
        //"relativeTime",
        "message"
      ],
      "returns": []
    },

    //"PushMessages": {
    //  "params": {
    //    "name": "messages",
    //    "type": "array",
    //    "item": [ "senderuserId", "timestamp", "messageText" ]
    //  }
    //},

    //TODO
    "DeleteFriend": {
      "params": [
        "userId"
      ],
      "returns": []
    }
  }
]
